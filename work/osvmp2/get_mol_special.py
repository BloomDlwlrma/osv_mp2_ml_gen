import os
import numpy
from pyscf import gto
from pyscf.df import addons
from orca2pyscf import *
import sys
sys.path.append("/home/ubuntu/Shiwei/gen_feature/orca2pyscf")

def get_atoms_string(coord_str):
    atom_list = []
    coord_list = coord_str.split("\n")
    for l in coord_list:
        if len(l) > 1:
            atom_list.append(l.split()[0])
    return atom_list

def get_atoms(mol):
    atom_list = []
    for ai in mol._atom:
        atom_list.append(ai[0])
    return atom_list


def parse_molpro(string, optimize=True):
    def optimize_contraction(basis):
        '''Search the basis segments which have the same exponents then merge them
        to the general contracted sets.
        Note the difference to the function :func:`to_general_contraction`. The
        return value of this function may still have multiple segments for each
        angular moment section.
        '''
        basdic = {}
        for b in basis:
            if isinstance(b[1], int):  # kappa = b[1]
                key = tuple(b[:2])
                ec = numpy.array(b[2:]).T
            else:
                key = tuple(b[:1])
                ec = numpy.array(b[1:]).T
            es = ec[0]
            cs = [c for c in ec[1:]]

            if key not in basdic:
                basdic[key] = []

            if basdic[key]:
                for e_cs in basdic[key]:
                    if numpy.array_equal(e_cs[0], es):
                        e_cs.extend(cs)
                        break
                else:
                    basdic[key].append([es] + cs)
            else:
                basdic[key].append([es] + cs)

        basis = []
        for key in sorted(basdic.keys()):
            l_kappa = list(key)
            for e_cs in basdic[key]:
                b = l_kappa + numpy.array(e_cs).T.tolist()
                basis.append(b)
        return basis
    def remove_zero(basis):
        '''
        Remove exponents if their contraction coefficients are all zeros.
        '''
        new_basis = []
        for b in basis:
            if isinstance(b[1], int):  # kappa = b[1]
                key = list(b[:2])
                ec = b[2:]
            else:
                key = list(b[:1])
                ec = b[1:]

            new_ec = [e_c for e_c in ec if any(c!=0 for c in e_c[1:])]
            if new_ec:
                new_basis.append(key + new_ec)
        return new_basis
    def _parse(raw_basis, optimize=True):
        # pass 1
        basis_add = []
        for dat in raw_basis:
            dat = dat.upper()
            if dat[0].isalpha():
                if '->' in dat:
                    # Skip the line of comments
                    continue
                status = dat
                val = []
                basis_add.append([status, val])
            else:
                val.append(dat)
        raw_basis = [[k, ' '.join(v)] for k,v in basis_add]

        # pass 2
        basis_add = []
        for status, valstring in raw_basis:
            tmp = status.split(':')
            key = tmp[0].split()
            l = MAPSPDF[key[1].upper()]
            #TODO if key[-1] == 'SV'
            val = tmp[1].split()
            np1 = int(val[0])
            nc = int(val[1])

            rawd = [float(x) for x in valstring.replace('E','e').split()]
            if nc == 0:
                for e in rawd:
                    basis_add.append([l, [e, 1.]])
            else:
                exps = numpy.array(rawd[:np1])
                coeff = numpy.zeros((np1,nc))
                p1 = np1
                for i in range(nc):
                    start, end = val[2+i].split('.')
                    start, end = int(start), int(end)
                    nd = end - start + 1
                    p0, p1 = p1, p1 + nd
                    coeff[start-1:end,i] = rawd[p0:p1]

                bval = numpy.hstack((exps[:,None], coeff))
                basis_add.append([l] + bval.tolist())

        basis_sorted = []
        for l in range(MAXL):
            basis_sorted.extend([b for b in basis_add if b[0] == l])

        if optimize:
            basis_sorted = optimize_contraction(basis_sorted)
        #print(basis_sorted)
        basis_sorted = remove_zero(basis_sorted)
        return basis_sorted
    MAXL = 12
    SPDF = 'SPDFGHIKLMNO'
    MAPSPDF = {key: l for l, key in enumerate(SPDF)}
    COMMENT_KEYWORDS = '!*#'
    raw_basis = []
    for x in string.splitlines():
        x = x.strip()
        if x and x[0] not in COMMENT_KEYWORDS:
            raw_basis.append(x)
    return _parse(raw_basis, optimize)


def get_M_molpro(coord, basis, verbose):
    ao_dic = {}
    ao_dic["ccpvtz"] = {
    "H": '''
    H s cc-pVTZ : 5 3 1.5 4.4 5.5
    3.387000E+01 5.095000E+00 1.159000E+00 3.258000E-01 1.027000E-01
    6.068000E-03 4.530800E-02 2.028220E-01 5.039030E-01
    3.834210E-01 1.000000E+00 1.000000E+00
    H p cc-pVTZ : 2 2 1.1 2.2
    1.407000E+00 3.880000E-01 1.000000E+00 1.000000E+00
    H d cc-pVTZ : 1 1 1.1
    1.057000E+00 1.0000000''',
    "C": '''
    C s cc-pVTZ : 10 4 1.10 1.10 8.8 10.10
    8.236000E+03 1.235000E+03 2.808000E+02 7.927000E+01 2.559000E+01
    8.997000E+00 3.319000E+00 9.059000E-01 3.643000E-01 1.285000E-01
    5.310000E-04 4.108000E-03 2.108700E-02 8.185300E-02 2.348170E-01
    4.344010E-01 3.461290E-01 3.937800E-02 -8.983000E-03 2.385000E-03
    -1.130000E-04 -8.780000E-04 -4.540000E-03 -1.813300E-02 -5.576000E-02 
    -1.268950E-01 -1.703520E-01 1.403820E-01 5.986840E-01 3.953890E-01 
    1.000000E+00 1.000000E+00
    C p cc-pVTZ : 5 3 1.5 4.4 5.5
    1.871000E+01 4.133000E+00 1.200000E+00 3.827000E-01 1.209000E-01
    1.403100E-02 8.686600E-02 2.902160E-01 5.010080E-01 3.434060E-01 
    1.000000E+00 1.000000E+00
    C d cc-pVTZ : 2 2 1.1 2.2
    1.097000E+00 3.180000E-01 1.000000E+00 1.000000E+00
    C f cc-pVTZ : 1 1 1.1
    7.610000E-01 1.0000000''',
    'N':'''
    N s cc-pVTZ : 10 4 1.10 8.8 1.10 10.10
    1.142000E+04 1.712000E+03 3.893000E+02 1.100000E+02 3.557000E+01
    1.254000E+01 4.644000E+00 1.293000E+00 5.118000E-01 1.787000E-01
    5.230000E-04 4.045000E-03 2.077500E-02 8.072700E-02 2.330740E-01
    4.335010E-01 3.474720E-01 4.126200E-02 -8.508000E-03 2.384000E-03
    1.000000E+00 -1.150000E-04 -8.950000E-04 -4.624000E-03 -1.852800E-02
    -5.733900E-02 -1.320760E-01 -1.725100E-01 1.518140E-01 5.999440E-01
    3.874620E-01 1.000000E+00
    N p cc-pVTZ : 5 3 4.4 1.5 5.5
    2.663000E+01 5.948000E+00 1.742000E+00 5.550000E-01 1.725000E-01
    1.000000E+00 1.467000E-02 9.176400E-02 2.986830E-01 4.984870E-01
    3.370230E-01 1.000000E+00
    N d cc-pVTZ : 2 2 1.1 2.2
    1.654000E+00 4.690000E-01 1.000000E+00 1.000000E+00
    N f cc-pVTZ : 1 1 1.1
    1.093000E+00 1.0000000''',
    'O':'''
    O s cc-pVTZ : 10 4 1.10 8.8 1.10 10.10
    1.533000E+04 2.299000E+03 5.224000E+02 1.473000E+02 4.755000E+01
    1.676000E+01 6.207000E+00 1.752000E+00 6.882000E-01 2.384000E-01
    5.080000E-04 3.929000E-03 2.024300E-02 7.918100E-02 2.306870E-01
    4.331180E-01 3.502600E-01 4.272800E-02 -8.154000E-03 2.381000E-03
    1.000000E+00 -1.150000E-04 -8.950000E-04 -4.636000E-03 -1.872400E-02
    -5.846300E-02 -1.364630E-01 -1.757400E-01 1.609340E-01 6.034180E-01
    3.787650E-01 1.000000E+00
    O p cc-pVTZ : 5 3 4.4 1.5 5.5
    3.446000E+01 7.749000E+00 2.280000E+00 7.156000E-01 2.140000E-01
    1.000000E+00 1.592800E-02 9.974000E-02 3.104920E-01 4.910260E-01
    3.363370E-01 1.000000E+00
    O d cc-pVTZ : 2 2 1.1 2.2
    2.314000E+00 6.450000E-01 1.000000E+00 1.000000E+00
    O f cc-pVTZ : 1 1 1.1
    1.428000E+00 1.0000000''',
    'S':'''
    S s cc-pVTZ : 15 5 1.15 1.15 13.13 1.15 15.15
    3.741000E+05 5.605000E+04 1.276000E+04 3.615000E+03 1.183000E+03
    4.288000E+02 1.678000E+02 6.947000E+01 2.984000E+01 1.272000E+01
    5.244000E+00 2.219000E+00 7.767000E-01 3.490000E-01 1.322000E-01
    5.421400E-05 4.208550E-04 2.206980E-03 9.192580E-03 3.211230E-02
    9.466830E-02 2.236300E-01 3.743930E-01 3.291080E-01 8.470380E-02
    4.408510E-04 1.648270E-03 -6.223320E-04 3.013060E-04 -8.412900E-05
    -1.498370E-05 -1.161980E-04 -6.115830E-04 -2.553700E-03 -9.087080E-03
    -2.770450E-02 -7.200200E-02 -1.464390E-01 -1.951500E-01 8.191930E-03
    5.166010E-01 5.421780E-01 6.884300E-02 -9.180720E-03 2.268320E-03
    1.000000E+00 4.350660E-06 3.371400E-05 1.776740E-04 7.411160E-04
    2.645910E-03 8.074870E-03 2.122760E-02 4.383230E-02 6.127160E-02
    -3.615100E-03 -2.045100E-01 -3.818710E-01 8.268440E-02 7.141470E-01
    3.937910E-01 1.000000E+00
    S p cc-pVTZ : 9 4 1.9 7.7 1.9 9.9
    5.744000E+02 1.358000E+02 4.319000E+01 1.587000E+01 6.208000E+00
    2.483000E+00 8.688000E-01 3.229000E-01 1.098000E-01 2.422640E-03
    1.927960E-02 8.854010E-02 2.546540E-01 4.339840E-01 3.549530E-01
    6.189410E-02 -5.029770E-03 2.098130E-03 1.000000E+00 -6.201020E-04
    -4.938820E-03 -2.326470E-02 -6.851950E-02 -1.238960E-01 -9.694990E-02
    2.282150E-01 5.693940E-01 3.663020E-01 1.000000E+00
    S d cc-pVTZ : 2 2 1.1 2.2
    8.190000E-01 2.690000E-01 1.000000E+00 1.000000E+00
    S f cc-pVTZ : 1 1 1.1
    5.570000E-01 1.0000000''',
    'CL':'''
    CL s cc-pVTZ : 15 5 1.15 1.15 13.13 1.15 15.15
    4.561000E+05 6.833000E+04 1.555000E+04 4.405000E+03 1.439000E+03
    5.204000E+02 2.031000E+02 8.396000E+01 3.620000E+01 1.583000E+01
    6.334000E+00 2.694000E+00 9.768000E-01 4.313000E-01 1.625000E-01
    4.929700E-05 3.830290E-04 2.008540E-03 8.385580E-03 2.947030E-02
    8.783250E-02 2.114730E-01 3.653640E-01 3.408840E-01 1.021330E-01
    3.116750E-03 1.057510E-03 -3.780000E-04 1.561360E-04 -5.141260E-05
    -1.383040E-05 -1.072790E-04 -5.650830E-04 -2.361350E-03 -8.458860E-03
    -2.596380E-02 -6.863620E-02 -1.418740E-01 -1.993190E-01 -1.956620E-02
    4.997410E-01 5.637360E-01 7.903250E-02 -8.350910E-03 2.324560E-03
    1.000000E+00 4.185460E-06 3.243950E-05 1.711050E-04 7.141760E-04
    2.567050E-03 7.885520E-03 2.108670E-02 4.422640E-02 6.516700E-02
    6.030120E-03 -2.064950E-01 -4.058710E-01 7.595580E-02 7.256610E-01
    3.944230E-01 1.000000E+00
    CL p cc-pVTZ : 9 4 1.9 7.7 1.9 9.9
    6.633000E+02 1.568000E+02 4.998000E+01 1.842000E+01 7.240000E+00
    2.922000E+00 1.022000E+00 3.818000E-01 1.301000E-01 2.404480E-03
    1.921480E-02 8.850970E-02 2.560200E-01 4.369270E-01 3.503340E-01
    5.854950E-02 -4.584230E-03 2.269700E-03 1.000000E+00 -6.521450E-04
    -5.194450E-03 -2.469380E-02 -7.281670E-02 -1.340300E-01 -9.477420E-02
    2.622890E-01 5.646670E-01 3.412500E-01 1.000000E+00
    CL d cc-pVTZ : 2 2 1.1 2.2
    1.046000E+00 3.440000E-01 1.000000E+00 1.000000E+00
    CL f cc-pVTZ : 1 1 1.1
    7.060000E-01 1.0000000'''
    }

    ao_dic["631g"] = {
    'AR':'''
    AR s 6-31G : 16 4 1.9 4.13 12.15 16.16
    0.2834830000E+05 0.4257620000E+04 0.9698570000E+03 0.5758910000E+03 0.2732630000E+03
    0.1368160000E+03 0.8736950000E+02 0.4380980000E+02 0.2968670000E+02 0.1620940000E+02
    0.6460840000E+01 0.3860280000E+01 0.2651140000E+01 0.1413730000E+01 0.5166460000E+00
    0.1738880000E+00 0.1825260192E-02 0.1396860147E-01 0.6870730723E-01 0.00000000
    0.2362040249E+00 0.00000000 0.4822140508E+00 0.00000000 0.3420430360E+00
    -0.2159720895E-02 0.00000000 -0.2907751206E-01 0.00000000 -0.1108270460E+00
    0.00000000 0.2769991148E-01 0.5776132395E+00 0.00000000 0.4886882026E+00
    -0.2555929604E+00 0.00000000 0.3780674206E-01 0.1080564060E+01 0.1000000000E+01
    AR p 6-31G : 10 3 1.7 6.9 10.10
    0.5758910000E+03 0.1368160000E+03 0.4380980000E+02 0.1620940000E+02 0.6460840000E+01
    0.3860280000E+01 0.2651140000E+01 0.1413730000E+01 0.5166460000E+00 0.1738880000E+00
    0.3806649842E-02 0.2923049879E-01 0.1264669948E+00 0.3235099866E+00 0.4548959811E+00
    0.00000000 0.2566299894E+00 -0.1591969040E-01 0.00000000 0.3246458042E+00
    0.7439895512E+00 0.1000000000E+01
    ''',
    'S':'''
    S s 6-31G : 16 4 1.9 4.13 12.15 16.16
    0.2191710000E+05 0.3301490000E+04 0.7541460000E+03 0.4237350000E+03 0.2127110000E+03
    0.1007100000E+03 0.6798960000E+02 0.3215990000E+02 0.2305150000E+02 0.1180790000E+02
    0.4631100000E+01 0.2615840000E+01 0.1870250000E+01 0.9221670000E+00 0.3412870000E+00
    0.1171670000E+00 0.1869240849E-02 0.1423030646E-01 0.6969623166E-01 0.00000000
    0.2384871083E+00 0.00000000 0.4833072195E+00 0.00000000 0.3380741536E+00
    -0.2376770499E-02 0.00000000 -0.3169300665E-01 0.00000000 -0.1133170238E+00
    0.00000000 0.5609001177E-01 0.5922551243E+00 0.00000000 0.4550060955E+00
    -0.2503731142E+00 0.00000000 0.6695676310E-01 0.1054506269E+01 0.1000000000E+01
    S p 6-31G : 10 3 1.7 6.9 10.10
    0.4237350000E+03 0.1007100000E+03 0.3215990000E+02 0.1180790000E+02 0.4631100000E+01
    0.2615840000E+01 0.1870250000E+01 0.9221670000E+00 0.3412870000E+00 0.1171670000E+00
    0.4061009982E-02 0.3068129986E-01 0.1304519994E+00 0.3272049985E+00 0.4528509980E+00
    0.00000000 0.2560419989E+00 -0.1451048955E-01 0.00000000 0.3102627765E+00
    0.7544824565E+00 0.1000000000E+01
    ''',
    'B':'''
    B s 6-31G : 10 3 1.7 6.9 10.10
    0.2068882250E+04 0.3106495700E+03 0.7068303300E+02 0.1986108030E+02 0.6299304840E+01
    0.4727971071E+01 0.2127026970E+01 0.1190337736E+01 0.3594116829E+00 0.1267512469E+00
    0.1866274590E-02 0.1425148170E-01 0.6955161850E-01 0.2325729330E+00 0.4670787120E+00
    0.00000000 0.3634314400E+00 -0.1303937974E+00 0.00000000 -0.1307889514E+00
    0.1130944484E+01 0.1000000000E+01
    B p 6-31G : 4 2 1.3 4.4
    0.4727971071E+01 0.1190337736E+01 0.3594116829E+00 0.1267512469E+00 0.7459757992E-01
    0.3078466771E+00 0.7434568342E+00 0.1000000000E+01
    ''',
    'H':'''
    H s 6-31G : 4 2 1.3 4.4
    0.1873113696E+02 0.2825394365E+01 0.6401216923E+00 0.1612777588E+00 0.3349460434E-01
    0.2347269535E+00 0.8137573261E+00 1.0000000
    ''',
    'C':'''
    C s 6-31G : 10 3 1.7 6.9 10.10
    0.3047524880E+04 0.4573695180E+03 0.1039486850E+03 0.2921015530E+02 0.9286662960E+01
    0.7868272350E+01 0.3163926960E+01 0.1881288540E+01 0.5442492580E+00 0.1687144782E+00
    0.1834737132E-02 0.1403732281E-01 0.6884262226E-01 0.2321844432E+00 0.4679413484E+00
    0.00000000 0.3623119853E+00 -0.1193324198E+00 0.00000000 -0.1608541517E+00
    0.1143456438E+01 0.1000000000E+01
    C p 6-31G : 4 2 1.3 4.4
    0.7868272350E+01 0.1881288540E+01 0.5442492580E+00 0.1687144782E+00 0.6899906659E-01
    0.3164239610E+00 0.7443082909E+00 0.1000000000E+01
    ''',
    'N':'''
    N s 6-31G : 10 3 1.7 6.9 10.10
    0.4173511460E+04 0.6274579110E+03 0.1429020930E+03 0.4023432930E+02 0.1282021290E+02
    0.1162636186E+02 0.4390437010E+01 0.2716279807E+01 0.7722183966E+00 0.2120314975E+00
    0.1834772160E-02 0.1399462700E-01 0.6858655181E-01 0.2322408730E+00 0.4690699481E+00
    0.00000000 0.3604551991E+00 -0.1149611817E+00 0.00000000 -0.1691174786E+00
    0.1145851947E+01 0.1000000000E+01
    N p 6-31G : 4 2 1.3 4.4
    0.1162636186E+02 0.2716279807E+01 0.7722183966E+00 0.2120314975E+00 0.6757974388E-01
    0.3239072959E+00 0.7408951398E+00 0.1000000000E+01
    ''',
    'O':'''
    O s 6-31G : 10 3 1.7 6.9 10.10
    0.5484671660E+04 0.8252349460E+03 0.1880469580E+03 0.5296450000E+02 0.1689757040E+02
    0.1553961625E+02 0.5799635340E+01 0.3599933586E+01 0.1013761750E+01 0.2700058226E+00
    0.1831074430E-02 0.1395017220E-01 0.6844507810E-01 0.2327143360E+00 0.4701928980E+00
    0.00000000 0.3585208530E+00 -0.1107775495E+00 0.00000000 -0.1480262627E+00
    0.1130767015E+01 0.1000000000E+01
    O p 6-31G : 4 2 1.3 4.4
    0.1553961625E+02 0.3599933586E+01 0.1013761750E+01 0.2700058226E+00 0.7087426823E-01
    0.3397528391E+00 0.7271585773E+00 0.1000000000E+01
    ''',
    'F':'''
    F s 6-31G : 10 3 1.7 6.9 10.10
    0.7001713090E+04 0.1051366090E+04 0.2392856900E+03 0.6739744530E+02 0.2151995730E+02
    0.2084795280E+02 0.7403101300E+01 0.4808308340E+01 0.1344069860E+01 0.3581513930E+00
    0.1819616901E-02 0.1391607961E-01 0.6840532453E-01 0.2331857601E+00 0.4712674392E+00
    0.00000000 0.3566185462E+00 -0.1085069751E+00 0.00000000 -0.1464516581E+00
    0.1128688581E+01 0.1000000000E+01
    F p 6-31G : 4 2 1.3 4.4
    0.2084795280E+02 0.4808308340E+01 0.1344069860E+01 0.3581513930E+00 0.7162872424E-01
    0.3459121027E+00 0.7224699564E+00 0.1000000000E+01
    '''
    }

    ao_dic["631g*"] = {
    'AR':'''
    AR s 6-31G* : 16 4 1.9 4.13 12.15 16.16
    0.2834830000E+05 0.4257620000E+04 0.9698570000E+03 0.5758910000E+03 0.2732630000E+03
    0.1368160000E+03 0.8736950000E+02 0.4380980000E+02 0.2968670000E+02 0.1620940000E+02
    0.6460840000E+01 0.3860280000E+01 0.2651140000E+01 0.1413730000E+01 0.5166460000E+00
    0.1738880000E+00 0.1825260192E-02 0.1396860147E-01 0.6870730723E-01 0.00000000
    0.2362040249E+00 0.00000000 0.4822140508E+00 0.00000000 0.3420430360E+00
    -0.2159720895E-02 0.00000000 -0.2907751206E-01 0.00000000 -0.1108270460E+00
    0.00000000 0.2769991148E-01 0.5776132395E+00 0.00000000 0.4886882026E+00
    -0.2555929604E+00 0.00000000 0.3780674206E-01 0.1080564060E+01 0.1000000000E+01
    AR p 6-31G* : 10 3 1.7 6.9 10.10
    0.5758910000E+03 0.1368160000E+03 0.4380980000E+02 0.1620940000E+02 0.6460840000E+01
    0.3860280000E+01 0.2651140000E+01 0.1413730000E+01 0.5166460000E+00 0.1738880000E+00
    0.3806649842E-02 0.2923049879E-01 0.1264669948E+00 0.3235099866E+00 0.4548959811E+00
    0.00000000 0.2566299894E+00 -0.1591969040E-01 0.00000000 0.3246458042E+00
    0.7439895512E+00 0.1000000000E+01
    AR d 6-31G* : 1 1 1.1
    0.8500000000E+00 1.0000000
    ''',
    'S':'''
    S s 6-31G* : 16 4 1.9 4.13 12.15 16.16
    0.2191710000E+05 0.3301490000E+04 0.7541460000E+03 0.4237350000E+03 0.2127110000E+03
    0.1007100000E+03 0.6798960000E+02 0.3215990000E+02 0.2305150000E+02 0.1180790000E+02
    0.4631100000E+01 0.2615840000E+01 0.1870250000E+01 0.9221670000E+00 0.3412870000E+00
    0.1171670000E+00 0.1869240849E-02 0.1423030646E-01 0.6969623166E-01 0.00000000
    0.2384871083E+00 0.00000000 0.4833072195E+00 0.00000000 0.3380741536E+00
    -0.2376770499E-02 0.00000000 -0.3169300665E-01 0.00000000 -0.1133170238E+00
    0.00000000 0.5609001177E-01 0.5922551243E+00 0.00000000 0.4550060955E+00
    -0.2503731142E+00 0.00000000 0.6695676310E-01 0.1054506269E+01 0.1000000000E+01
    S p 6-31G* : 10 3 1.7 6.9 10.10
    0.4237350000E+03 0.1007100000E+03 0.3215990000E+02 0.1180790000E+02 0.4631100000E+01
    0.2615840000E+01 0.1870250000E+01 0.9221670000E+00 0.3412870000E+00 0.1171670000E+00
    0.4061009982E-02 0.3068129986E-01 0.1304519994E+00 0.3272049985E+00 0.4528509980E+00
    0.00000000 0.2560419989E+00 -0.1451048955E-01 0.00000000 0.3102627765E+00
    0.7544824565E+00 0.1000000000E+01
    S d 6-31G* : 1 1 1.1
    0.6500000000E+00 1.0000000
    ''',
    'B':'''
    B s 6-31G* : 10 3 1.7 6.9 10.10
    0.2068882250E+04 0.3106495700E+03 0.7068303300E+02 0.1986108030E+02 0.6299304840E+01
    0.4727971071E+01 0.2127026970E+01 0.1190337736E+01 0.3594116829E+00 0.1267512469E+00
    0.1866274590E-02 0.1425148170E-01 0.6955161850E-01 0.2325729330E+00 0.4670787120E+00
    0.00000000 0.3634314400E+00 -0.1303937974E+00 0.00000000 -0.1307889514E+00
    0.1130944484E+01 0.1000000000E+01
    B p 6-31G* : 4 2 1.3 4.4
    0.4727971071E+01 0.1190337736E+01 0.3594116829E+00 0.1267512469E+00 0.7459757992E-01
    0.3078466771E+00 0.7434568342E+00 0.1000000000E+01
    B d 6-31G* : 1 1 1.1
    0.6000000000E+00 1.0000000
    ''',
    'H':'''
    H s 6-31G* : 4 2 1.3 4.4
    0.1873113696E+02 0.2825394365E+01 0.6401216923E+00 0.1612777588E+00 0.3349460434E-01
    0.2347269535E+00 0.8137573261E+00 1.0000000
    ''',
    'C':'''
    C s 6-31G* : 10 3 1.7 6.9 10.10
    0.3047524880E+04 0.4573695180E+03 0.1039486850E+03 0.2921015530E+02 0.9286662960E+01
    0.7868272350E+01 0.3163926960E+01 0.1881288540E+01 0.5442492580E+00 0.1687144782E+00
    0.1834737132E-02 0.1403732281E-01 0.6884262226E-01 0.2321844432E+00 0.4679413484E+00
    0.00000000 0.3623119853E+00 -0.1193324198E+00 0.00000000 -0.1608541517E+00
    0.1143456438E+01 0.1000000000E+01
    C p 6-31G* : 4 2 1.3 4.4
    0.7868272350E+01 0.1881288540E+01 0.5442492580E+00 0.1687144782E+00 0.6899906659E-01
    0.3164239610E+00 0.7443082909E+00 0.1000000000E+01
    C d 6-31G* : 1 1 1.1
    0.8000000000E+00 1.0000000
    ''',
    'N':'''
    N s 6-31G* : 10 3 1.7 6.9 10.10
    0.4173511460E+04 0.6274579110E+03 0.1429020930E+03 0.4023432930E+02 0.1282021290E+02
    0.1162636186E+02 0.4390437010E+01 0.2716279807E+01 0.7722183966E+00 0.2120314975E+00
    0.1834772160E-02 0.1399462700E-01 0.6858655181E-01 0.2322408730E+00 0.4690699481E+00
    0.00000000 0.3604551991E+00 -0.1149611817E+00 0.00000000 -0.1691174786E+00
    0.1145851947E+01 0.1000000000E+01
    N p 6-31G* : 4 2 1.3 4.4
    0.1162636186E+02 0.2716279807E+01 0.7722183966E+00 0.2120314975E+00 0.6757974388E-01
    0.3239072959E+00 0.7408951398E+00 0.1000000000E+01
    N d 6-31G* : 1 1 1.1
    0.8000000000E+00 1.0000000
    ''',
    'O':'''
    O s 6-31G* : 10 3 1.7 6.9 10.10
    0.5484671660E+04 0.8252349460E+03 0.1880469580E+03 0.5296450000E+02 0.1689757040E+02
    0.1553961625E+02 0.5799635340E+01 0.3599933586E+01 0.1013761750E+01 0.2700058226E+00
    0.1831074430E-02 0.1395017220E-01 0.6844507810E-01 0.2327143360E+00 0.4701928980E+00
    0.00000000 0.3585208530E+00 -0.1107775495E+00 0.00000000 -0.1480262627E+00
    0.1130767015E+01 0.1000000000E+01
    O p 6-31G* : 4 2 1.3 4.4
    0.1553961625E+02 0.3599933586E+01 0.1013761750E+01 0.2700058226E+00 0.7087426823E-01
    0.3397528391E+00 0.7271585773E+00 0.1000000000E+01
    O d 6-31G* : 1 1 1.1
    0.8000000000E+00 1.0000000
    ''',
    'F':'''
    F s 6-31G* : 10 3 1.7 6.9 10.10
    0.7001713090E+04 0.1051366090E+04 0.2392856900E+03 0.6739744530E+02 0.2151995730E+02
    0.2084795280E+02 0.7403101300E+01 0.4808308340E+01 0.1344069860E+01 0.3581513930E+00
    0.1819616901E-02 0.1391607961E-01 0.6840532453E-01 0.2331857601E+00 0.4712674392E+00
    0.00000000 0.3566185462E+00 -0.1085069751E+00 0.00000000 -0.1464516581E+00
    0.1128688581E+01 0.1000000000E+01
    F p 6-31G* : 4 2 1.3 4.4
    0.2084795280E+02 0.4808308340E+01 0.1344069860E+01 0.3581513930E+00 0.7162872424E-01
    0.3459121027E+00 0.7224699564E+00 0.1000000000E+01
    F d 6-31G* : 1 1 1.1
    0.8000000000E+00 1.0000000
    '''
    }

    basis = basis.replace("-", "").lower()
    if basis in ao_dic.keys():
        mol = gto.Mole()
        mol.atom = coord
        atom_list = get_atoms_string(coord)
        mol.basis = {}
        for ia in set(atom_list):
            mol.basis[ia] = parse_molpro(ao_dic[basis][ia.upper()])
        mol.charge=int(os.environ.get("charge", 0))
        mol.build(verbose=verbose)
        return mol
    else:
        raise NotImplementedError("Basis %s not available"%basis)
    
def get_aux_molpro(mol, basis, mp2fit=False):
    aux_dic = {"jkfit":{}, "rifit":{}}
    aux_dic["jkfit"]["ccpvtz"] = {
    "H": '''
    H s cc-pVTZ-JKFIT : 4 4 1.1 2.2 3.3 4.4
    9.5302493327 1.9174506246 0.68424049142 0.28413255710 1.0000000
    1.0000000 1.0000000 1.0000000
    H p cc-pVTZ-JKFIT : 3 3 1.1 2.2 3.3
    2.9133232035 1.2621205398 0.50199775874 1.0000000 1.0000000
    1.0000000
    H d cc-pVTZ-JKFIT : 2 2 1.1 2.2
    2.3135329149 0.71290724024 1.0000000 1.0000000
    H f cc-pVTZ-JKFIT : 1 1 1.1
    1.6565726132 1.0000000''',
    "C": '''
    C s cc-pVTZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1113.9867719 369.16234180 121.79275232 48.127114540 20.365074004
    8.0883596856 2.5068656570 1.2438537380 0.48449899601 0.19185160296
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C p cc-pVTZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    102.99176249 28.132594009 9.8364318173 3.3490544980 1.4947618613
    0.57690108899 0.20320063291 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    C d cc-pVTZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    10.594068356 3.5997195366 1.3355691094 0.51949764954 0.19954125200
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C f cc-pVTZ-JKFIT : 2 2 1.1 2.2
    1.19486633836900000000 .41586633836900000000 1.0000000 1.0000000
    C g cc-pVTZ-JKFIT : 1 1 1.1
    .85886633836900000000 1.0000000''',
    'N':'''
    N s cc-pVTZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1102.8622453 370.98041153 136.73555938 50.755871924 20.535656095
    7.8318737184 3.4784063855 1.4552856603 0.63068989071 0.27276596483
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N p cc-pVTZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    93.540954073 29.524019527 10.917502987 4.3449288991 1.8216912640
    0.75792424494 0.28241469033 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    N d cc-pVTZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    16.419378926 5.0104049385 1.9793971884 0.78495771518 0.28954065963
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N f cc-pVTZ-JKFIT : 2 2 1.1 2.2
    1.79354239843000000000 .60854239843000000000 1.0000000 1.0000000
    N g cc-pVTZ-JKFIT : 1 1 1.1
    1.23254239843000000000 1.0000000''',
    'O':'''
    O s cc-pVTZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1517.8667506 489.67952008 176.72118665 63.792233137 25.366499130
    9.9135491200 4.4645306584 1.8017743661 0.80789710965 0.33864326862
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O p cc-pVTZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    120.16030921 34.409622474 12.581148610 5.0663824249 2.0346927092
    0.86092967212 0.36681356726 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    O d cc-pVTZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    19.043062805 5.8060381104 2.1891841580 0.87794613558 0.35623646700
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O f cc-pVTZ-JKFIT : 2 2 1.1 2.2
    2.49391478813500000000 .82491478813500000000 1.0000000 1.0000000
    O g cc-pVTZ-JKFIT : 1 1 1.1
    1.60791478813500000000 1.0000000''',
    'S':'''
    S s cc-pVTZ-JKFIT : 13 13 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11 12.12 13.13
    6402.4580816 1704.9249408 598.09038904 225.90920364 94.426261909
    37.222420840 18.259106532 8.7937857291 4.4619424717 2.2735987703
    0.78075394724 0.48191153763 0.21573555055 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    S p cc-pVTZ-JKFIT : 11 11 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11
    796.16481618 226.17928266 85.598645757 36.268978384 16.325207000
    7.6145421568 3.3388129956 1.8665221526 0.94025159837 0.51521255747
    0.26318380469 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000
    S d cc-pVTZ-JKFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    190.55658672 60.346801430 25.141967063 12.146768196 6.2993488132
    3.0706106656 1.2911977798 0.56678602865 0.24192419172 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000
    S f cc-pVTZ-JKFIT : 3 3 1.1 2.2 3.3
    3.3096133 .94560380031500000000 .39560380031500000000 1.0000000 1.0000000
    1.0000000
    S g cc-pVTZ-JKFIT : 1 1 1.1
    sulfur (13s,11p,9d,3f,1g) -> [13s,11p,9d,3f,1g] converted by Basis Set Exchange
    .68360380031500000000 1.0000000''',
    'CL':'''
    CL s cc-pVTZ-JKFIT : 13 13 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11 12.12 13.13
    7082.7970581 2109.3095076 768.41281873 284.79255416 116.55331731
    46.394820985 21.956303390 9.9930272138 4.7199459556 2.6573396159
    1.0813481129 0.53154679199 0.23367039059 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    CL p cc-pVTZ-JKFIT : 11 11 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11
    973.73528509 278.99109347 105.88644516 45.231846876 20.289166152
    9.5829383791 4.4641678563 2.3625612120 1.1491964243 0.60310217244
    0.30590911334 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000
    CL d cc-pVTZ-JKFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    204.38030063 63.693893315 25.726668979 11.602467273 5.4574541509
    2.8838397619 1.3394023625 0.61649222177 0.27470143212 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000
    CL f cc-pVTZ-JKFIT : 3 3 1.1 2.2 3.3
    4.2040664 1.20116183076000000000 .49916183076000000000 1.0000000 1.0000000
    1.0000000
    CL g cc-pVTZ-JKFIT : 1 1 1.1
    .86116183076000000000 1.0000000'''
    }
    aux_dic["rifit"]["ccpvtz"] = {
    "H": '''
    H s cc-pVTZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    8.5128275910 1.8730891166 0.52618426941 0.28973989936 1.0000000
    1.0000000 1.0000000 1.0000000
    H p cc-pVTZ-RIFIT : 3 3 1.1 2.2 3.3
    2.3725491635 1.1804084468 0.60382204241 1.0000000 1.0000000
    1.0000000
    H d cc-pVTZ-RIFIT : 2 2 1.1 2.2
    1.8096373189 1.1439726055 1.0000000 1.0000000
    H f cc-pVTZ-RIFIT : 1 1 1.1
    1.8063060576 1.0000000''',
    "C": '''
    C s cc-pVTZ-RIFIT : 8 8 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8
    280.55661188 60.230247191 22.116650824 6.8620932896 1.5622549539
    0.91245045495 0.50274917044 0.21582348749 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    C p cc-pVTZ-RIFIT : 6 6 1.1 2.2 3.3 4.4 5.5 6.6
    24.231865176 6.4764514185 2.1290884677 1.0375639746 0.54941275046
    0.28152652231 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000
    C d cc-pVTZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    9.7189810815 3.0351475003 1.4677737562 0.57370827909 0.29055589668
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C f cc-pVTZ-RIFIT : 3 3 1.1 2.2 3.3
    2.2756201303 1.1968898852 0.54157487216 1.0000000 1.0000000
    1.0000000
    C g cc-pVTZ-RIFIT : 1 1 1.1
    1.2166101638 1.0000000''',
    'N':'''
    N s cc-pVTZ-RIFIT : 8 8 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8
    287.50926947 64.276030898 21.681924016 7.9068743193 2.4319673913
    1.2226681474 0.76674827356 0.31158846994 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    N p cc-pVTZ-RIFIT : 6 6 1.1 2.2 3.3 4.4 5.5 6.6
    34.965027371 10.323896648 2.8981582643 1.4077404555 0.85083386536
    0.37353274145 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000
    N d cc-pVTZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    13.908637089 4.5847232531 2.2101848651 0.83768301209 0.41948375608
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N f cc-pVTZ-RIFIT : 3 3 1.1 2.2 3.3
    3.4730665788 1.5589463548 0.84677638239 1.0000000 1.0000000
    1.0000000
    N g cc-pVTZ-RIFIT : 1 1 1.1
    1.7764066281 1.0000000''',
    'O':'''
    O s cc-pVTZ-RIFIT : 8 8 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8
    366.54531503 76.693314858 24.573835091 8.4165585072 3.0202080356
    1.3331563617 0.81250658727 0.36505253662 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    O p cc-pVTZ-RIFIT : 6 6 1.1 2.2 3.3 4.4 5.5 6.6
    52.854386423 15.021795824 3.9137719482 2.1678840611 0.97419243984
    0.51845615412 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000
    O d cc-pVTZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    15.907733132 5.3799329215 2.9552623921 1.1624458997 0.50353399421
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O f cc-pVTZ-RIFIT : 3 3 1.1 2.2 3.3
    4.6873846701 2.1512789489 1.0894068169 1.0000000 1.0000000
    1.0000000
    O g cc-pVTZ-RIFIT : 1 1 1.1
    2.3270964878 1.0000000''',
    'S':'''
    S s cc-pVTZ-RIFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    346.16017332 118.06876908 42.578791044 15.071846966 8.1659985107
    3.9280038769 1.6777617483 0.91820057563 0.44980119431 0.19303132669
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    S p cc-pVTZ-RIFIT : 8 8 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8
    115.32161487 13.254732077 4.9407509434 3.2049351631 1.1289904570
    0.75385133161 0.47415719132 0.25144736038 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    S d cc-pVTZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    48.438228356 13.502099428 6.4575348551 2.9572042760 1.2447399028
    0.60349292506 0.25568350004 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    S f cc-pVTZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    11.302730326 4.9503455707 1.8154279285 1.0290097097 0.48920031399
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    S g cc-pVTZ-RIFIT : 2 2 1.1 2.2
    2.9569474559 0.86383824993 1.0000000 1.0000000''',
    'CL':'''
    CL s cc-pVTZ-RIFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    396.32919852 131.64020777 46.777303924 17.032290106 8.9255877706
    4.0496319107 1.7232820168 1.0579996073 0.54156678831 0.22731800705
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    CL p cc-pVTZ-RIFIT : 8 8 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8
    130.86379708 15.683454996 5.3330790082 3.6210888683 1.3633140276
    0.84335129277 0.56661784935 0.29454644901 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    CL d cc-pVTZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    44.369007595 13.056776020 6.1212696420 3.0485507141 1.4570288737
    0.71121397428 0.30413816531 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    CL f cc-pVTZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    13.334635630 5.1060775290 2.0068485693 1.2815228635 0.59658382256
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    CL g cc-pVTZ-RIFIT : 2 2 1.1 2.2
    3.6953007741 1.0946908098 1.0000000 1.0000000'''
    }

    aux_dic["jkfit"]["ccpvdz"] = {
    'AR':'''
    AR s cc-pVDZ-JKFIT : 13 13 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11 12.12 13.13
    7763.136000 2513.694100 938.735200 343.675900 138.680400
    55.567200 25.653500 11.192300 4.977900 3.041100
    1.381900 0.581200 0.251600 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    AR p cc-pVDZ-JKFIT : 11 11 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11
    1151.305800 331.802900 126.174200 54.194700 24.253100
    11.551300 5.589500 2.858600 1.358100 0.691000
    0.348600 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000
    AR d cc-pVDZ-JKFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    218.204000 67.041000 26.311400 11.058200 4.615600
    2.697100 1.387600 0.666200 0.307500 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000
    AR f cc-pVDZ-JKFIT : 3 3 1.1 2.2 3.3
    5.098500 1.456700 0.602700 1.0000000 1.0000000
    1.0000000
    ''',
    'S':'''
    S s cc-pVDZ-JKFIT : 13 13 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11 12.12 13.13
    6402.458082 1704.924941 598.090389 225.909204 94.426262
    37.222421 18.259107 8.793786 4.461942 2.273599
    0.780754 0.481912 0.215736 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000
    S p cc-pVDZ-JKFIT : 11 11 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10 11.11
    796.164816 226.179283 85.598646 36.268978 16.325207
    7.614542 3.338813 1.866522 0.940252 0.515213
    0.263184 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000
    S d cc-pVDZ-JKFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    190.556587 60.346801 25.141967 12.146768 6.299349
    3.070611 1.291198 0.566786 0.241924 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000
    S f cc-pVDZ-JKFIT : 3 3 1.1 2.2 3.3
    3.309613 0.945604 0.395604 1.0000000 1.0000000
    1.0000000
    ''',
    'B':'''
    B s cc-pVDZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    441.889132 92.069630 29.978449 11.426331 4.380872
    2.059403 0.901157 0.524553 0.246347 0.120858
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    B p cc-pVDZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    229.951152 36.381695 12.119797 3.844113 1.100276
    0.397331 0.135148 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000
    B d cc-pVDZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    9.364337 3.103566 1.200684 0.408296 0.131883
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    B f cc-pVDZ-JKFIT : 2 2 1.1 2.2
    0.723591 0.261591 1.0000000 1.0000000
    ''',
    'H':'''
    H s cc-pVDZ-JKFIT : 4 4 1.1 2.2 3.3 4.4
    9.5302493327 1.9174506246 0.68424049142 0.28413255710 1.0000000
    1.0000000 1.0000000 1.0000000
    H p cc-pVDZ-JKFIT : 3 3 1.1 2.2 3.3
    2.9133232035 1.2621205398 0.50199775874 1.0000000 1.0000000
    1.0000000
    H d cc-pVDZ-JKFIT : 2 2 1.1 2.2
    2.3135329149 0.71290724024 1.0000000 1.0000000
    ''',
    'C':'''
    C s cc-pVDZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1113.9867719 369.16234180 121.79275232 48.127114540 20.365074004
    8.0883596856 2.5068656570 1.2438537380 0.48449899601 0.19185160296
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C p cc-pVDZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    102.99176249 28.132594009 9.8364318173 3.3490544980 1.4947618613
    0.57690108899 0.20320063291 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    C d cc-pVDZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    10.594068356 3.5997195366 1.3355691094 0.51949764954 0.19954125200
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C f cc-pVDZ-JKFIT : 2 2 1.1 2.2
    1.19486633836900000000 0.41586633836900000000 1.0000000 1.0000000
    ''',
    'N':'''
    N s cc-pVDZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1102.8622453 370.98041153 136.73555938 50.755871924 20.535656095
    7.8318737184 3.4784063855 1.4552856603 0.63068989071 0.27276596483
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N p cc-pVDZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    93.540954073 29.524019527 10.917502987 4.3449288991 1.8216912640
    0.75792424494 0.28241469033 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    N d cc-pVDZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    16.419378926 5.0104049385 1.9793971884 0.78495771518 0.28954065963
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N f cc-pVDZ-JKFIT : 2 2 1.1 2.2
    1.79354239843000000000 0.60854239843000000000 1.0000000 1.0000000
    ''',
    'O':'''
    O s cc-pVDZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1517.8667506 489.67952008 176.72118665 63.792233137 25.366499130
    9.9135491200 4.4645306584 1.8017743661 0.80789710965 0.33864326862
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O p cc-pVDZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    120.16030921 34.409622474 12.581148610 5.0663824249 2.0346927092
    0.86092967212 0.36681356726 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    O d cc-pVDZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    19.043062805 5.8060381104 2.1891841580 0.87794613558 0.35623646700
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O f cc-pVDZ-JKFIT : 2 2 1.1 2.2
    2.49391478813500000000 .82491478813500000000 1.0000000 1.0000000
    O g cc-pVDZ-JKFIT : 1 1 1.1
    1.60791478813500000000 1.0000000
    ''',
    'F':'''
    F s cc-pVDZ-JKFIT : 10 10 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9 10.10
    1885.0661216 623.75582297 227.92405029 82.184178773 32.628937583
    12.783279578 5.6589257943 2.3208306681 1.0191520908 0.42196699118
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    F p cc-pVDZ-JKFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    153.72069768 45.390450866 16.785845772 6.7293857800 2.6694607033
    1.1049787101 0.45727703601 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    F d cc-pVDZ-JKFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    24.869685349 7.5554441579 2.8268499237 1.1123341279 0.43877754231
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    F f cc-pVDZ-JKFIT : 2 2 1.1 2.2
    3.33539640054000000000 1.08339640054000000000 1.0000000 1.0000000
    '''
    }

    aux_dic["rifit"]["ccpvdz"] = {
    'AR':'''
    AR s cc-pVDZ-RIFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    378.66434876 70.670080873 25.843103323 10.785164286 5.6249779041
    2.5479064229 1.2671593110 0.56633577681 0.26605484967 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000
    AR p cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    228.79690746 12.956277791 7.9337123588 3.3338952941 1.0705004857
    0.66636036510 0.26912704043 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    AR d cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    34.064919042 8.9940417514 4.3963711570 1.2809077455 0.43291740989
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    AR f cc-pVDZ-RIFIT : 3 3 1.1 2.2 3.3
    12.882820892 5.3016322810 1.2299876404 1.0000000 1.0000000
    1.0000000
    ''',
    'S':'''
    S s cc-pVDZ-RIFIT : 9 9 1.1 2.2 3.3 4.4 5.5 6.6 7.7 8.8 9.9
    227.60646032 54.508181284 15.451153681 7.5007056080 3.6362479527
    1.1980042928 0.71990131761 0.39226646706 0.16764088728 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000
    S p cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    100.47953874 15.326806835 6.8173521903 2.7058319273 1.1299976805
    0.70680651766 0.29477453339 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    S d cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    26.396605608 6.3311048407 3.3963555444 0.84273413903 0.32730964913
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    S f cc-pVDZ-RIFIT : 3 3 1.1 2.2 3.3
    9.0052797251 3.7488657108 0.80415427800 1.0000000 1.0000000
    1.0000000
    ''',
    'B':'''
    B s cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    53.62416922 10.64768174 4.02090771 1.20371751 0.55743169
    0.26732426 0.11742728 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    B p cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    16.72177690 5.11531213 1.36387558 0.54219482 0.21504896
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    B d cc-pVDZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    2.47967914 0.77325939 0.37335687 0.16785145 1.0000000
    1.0000000 1.0000000 1.0000000
    B f cc-pVDZ-RIFIT : 2 2 1.1 2.2
    2.52772462 0.56505305 1.0000000 1.0000000
    ''',
    'H':'''
    H s cc-pVDZ-RIFIT : 3 3 1.1 2.2 3.3
    5.115890 1.142965 0.291662 1.0000000 1.0000000 
    1.0000000
    H p cc-pVDZ-RIFIT : 2 2 1.1 2.2
    1.914964 0.986401 1.0000000 1.0000000
    H d cc-pVDZ-RIFIT : 1 1 1.1
    1.172083 1.0000000
    ''',
    'C':'''
    C s cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    62.745300 13.804500 4.772770 1.513330 0.782697
    0.409072 0.206796 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000
    C p cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    20.885100 6.005230 1.720600 0.754465 0.321667
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    C d cc-pVDZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    10.171500 2.678440 0.922515 0.340842 1.0000000 
    1.0000000 1.0000000 1.0000000
    C f cc-pVDZ-RIFIT : 2 2 1.1 2.2 
    2.742930 0.895756 1.0000000 1.0000000
    ''',
    'N':'''
    N s cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7 
    87.686400 20.467900 7.624360 2.344260 1.123240
    0.723539 0.327261 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000
    N p cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    29.237300 8.552990 2.533640 1.094610 0.461104
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    N d cc-pVDZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    12.327800 3.428160 1.285370 0.477850 1.0000000 
    1.0000000 1.0000000 1.0000000
    N f cc-pVDZ-RIFIT : 2 2 1.1 2.2
    3.401180 1.334730 1.0000000 1.0000000
    ''',
    'O':'''
    O s cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    109.461000 25.578000 9.551480 2.939600 1.396380
    0.905061 0.421376 1.0000000 1.0000000 1.0000000 
    1.0000000 1.0000000 1.0000000 1.0000000
    O p cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    36.129200 10.881700 3.205940 1.403870 0.612763 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    O d cc-pVDZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    15.251100 4.520870 1.812210 0.592201 1.0000000 
    1.0000000 1.0000000 1.0000000
    O f cc-pVDZ-RIFIT : 2 2 1.1 2.2
    4.221940 1.790210 1.0000000 1.0000000
    ''',
    'F':'''
    F s cc-pVDZ-RIFIT : 7 7 1.1 2.2 3.3 4.4 5.5 6.6 7.7
    130.337000 31.839300 11.017900 3.706770 1.736570
    1.084240 0.536595 1.0000000 1.0000000 1.0000000
    1.0000000 1.0000000 1.0000000 1.0000000
    F p cc-pVDZ-RIFIT : 5 5 1.1 2.2 3.3 4.4 5.5
    42.927100 12.631400 4.257910 1.912180 0.786730 
    1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
    F d cc-pVDZ-RIFIT : 4 4 1.1 2.2 3.3 4.4
    19.925300 5.966640 2.446780 0.743695 1.0000000 
    1.0000000 1.0000000 1.0000000
    F f cc-pVDZ-RIFIT : 2 2 1.1 2.2
    5.754130 2.445790 1.0000000 1.0000000
    '''
    }

    basis = basis.replace("-", "").lower()
    if basis in ["631g", "631g*"]:
        basis = "ccpvdz"
    if mp2fit:
        fit_type = "rifit"
    else:
        fit_type = "jkfit"
    if basis in aux_dic[fit_type].keys():
        atom_list = get_atoms(mol)
        auxbasis = {}
        for ia in set(atom_list):
            auxbasis[ia] = parse_molpro(aux_dic[fit_type][basis][ia.upper()])
        return auxbasis
    else:
        raise NotImplementedError("Basis %s not available"%basis)

def get_M(coord, verbose):
    mol = gto.Mole()
    mol.atom = coord
    if "Be" in coord:
        mol.basis = {"Be": gto.basis.parse('''
        Be    S
        2940.0000000              0.0006800             -0.0001230        
            441.2000000              0.0052360             -0.0009660        
            100.5000000              0.0266060             -0.0048310        
            28.4300000              0.0999930             -0.0193140        
            9.1690000              0.2697020             -0.0532800        
            3.1960000              0.4514690             -0.1207230        
            1.1590000              0.2950740             -0.1334350        
            0.1811000              0.0125870              0.5307670        
        Be    S
            0.0589000              1.0000000  
        ''')}
    elif 'Au' in coord:
        #Basis set ECP60MDF_AVTZ for Au, ECP60MDF
        mol.basis = {'Au': 'aug-cc-pvtz-pp', 'C':'ccpvtzf12nz', 'P':'ccpvtzf12nz', 'N':'ccpvtzf12nz', 'H':'ccpvtzf12nz'}
        mol.ecp= {'Au':gto.basis.parse_ecp('''
        Au nelec 60
        Au ul
        2      1.0000000              0.0000000        
        Au S
        2     13.5232180            426.6418670        
        2      6.2643840             36.8006680        
        Au P
        2     11.4138670             87.0020910        
        2     10.3292150            174.0043700        
        2      5.7074240              8.8706100        
        2      4.8281650             17.9024380        
        Au D
        2      7.4309630             49.8836550        
        2      8.3219900             74.6845490        
        2      4.6096420              6.4862270        
        2      3.5115070              9.5468210        
        Au F
        2      3.0846390              8.7916400        
        2      3.0247430             11.6584560        
        Au G
        2      3.9784420             -5.2343370        
        2      4.0114910             -6.7381420
        ''')}
    elif 'Cu' in coord:
        #cc-pvtz-pp Basis set and ECP for Cu, ccpvtz for other atoms
        mol.basis = {'Cu':'cc-pvtz-pp', 'C':'cc-pvtz', 'O':'cc-pvtz', 'N':'cc-pvtz', 'Br':'cc-pvtz', 'H':'cc-pvtz'}
        mol.ecp= {'Cu':gto.basis.parse_ecp(
        '''
        Cu nelec 10
        Cu ul
        2       1.0000000              0.0000000
        Cu S
        2      30.1105430            355.7505120
        2      13.0763100             70.9309060
        Cu P
        2      32.6926140             77.9699310
        2      32.7703390            155.9274480
        2      13.7510670             18.0211320
        2      13.3221660             36.0943720
        Cu D
        2      38.9965110            -12.3434100
        2      39.5397880            -18.2733620
        2      12.2875110             -0.9847050
        2      11.4593000             -1.3187470
        Cu F
        2       6.1901020             -0.2272640
        2       8.1187800             -0.4687730
        ''')}
    elif 'Pt' in coord:
        mol.basis = {'Pt':'cc-pvtz-pp', 'C':'cc-pvtz', 'O':'cc-pvtz', 'N':'cc-pvtz', 'H':'cc-pvdz'}
        mol.ecp= {'Pt':gto.basis.parse_ecp(
        '''
        Pt nelec 60
        Pt ul
        2       1.00000000             0.00000000
        Pt S
        2      14.60450000           429.64608700
        2       7.21828700            73.15688400
        Pt P
        2      11.57716200            88.02291700
        2      10.88384300           175.99819600
        2       6.42440300            13.68227400
        2       5.22419800            27.41465100
        Pt D
        2       7.69961000            43.55785200
        2       7.55080800            65.36910800
        2       3.96116400             7.01859600
        2       3.87277700            11.39173300
        Pt F
        2       3.37986900            10.71022000
        2       3.32625500            14.27812500
        Pt G
        2       5.45202000           -11.65174900
        2       5.41258500           -14.37552500
        ''')}
    mol.charge=int(os.environ.get("charge", 0))
    mol.build(verbose=verbose)
    return mol

def get_aux(mol, mp2fit=False):
    atom_list = get_atoms(mol)
    if "Be" in atom_list:
        if mp2fit == False:
            auxbasis = {'Be': gto.basis.parse(
            '''
            Be    S
                41.8746                 1.0000000
            Be    S
                8.51217                1.0000000
            Be    S
                3.10685                1.0000000
            Be    S
                1.0695                 1.0000000
            Be    S
                0.43143                1.0000000
            Be    S
                0.213349               1.0000000
            Be    S
                0.124175               1.0000000
            ''')}
        else:
            auxbasis = {'Be': gto.basis.parse(
            '''
            Be    S
                41.8746                 1.0000000
            Be    S
                8.51217                1.0000000
            Be    S
                3.10685                1.0000000
            Be    S
                1.0695                 1.0000000
            Be    S
                0.43143                1.0000000
            Be    S
                0.213349               1.0000000
            Be    S
                0.124175               1.0000000
            ''')}
    elif 'Au' in atom_list:
        auxbasis = {'Au': gto.basis.parse(
        '''Au S
            15.8646600              1.0000000
        Au S
            10.5863500              1.0000000
        Au S
            7.0672090              1.0000000
        Au S
            2.9724350              1.0000000
        Au S
            1.9834000              1.0000000
        Au S
            1.2448000              1.0000000
        Au S
            0.8319210              1.0000000
        Au P
            11.7883500              1.0000000
        Au P
            8.0161500              1.0000000
        Au P
            2.6637000              1.0000000
        Au P
            1.1410000              1.0000000
        Au P
            0.7680020              1.0000000
        Au P
            0.1822350              1.0000000
        Au D
            11.5463000              1.0000000
        Au D
            7.7001940              1.0000000
        Au D
            3.4696000              1.0000000
        Au D
            1.2171000              1.0000000
        Au D
            0.5904350              1.0000000
        Au D
            0.2063210              1.0000000
        Au F
            5.7087640              1.0000000
        Au F
            3.8055220              1.0000000
        Au F
            2.5389910              1.0000000
        Au F
            0.8029970              1.0000000
        Au F
            0.3058530              1.0000000
        Au G
            6.0586110              1.0000000
        Au G
            4.0649930              1.0000000
        Au G
            2.7283000              1.0000000
        Au G
            0.8213260              1.0000000
        Au G
            0.3668080              1.0000000
        Au H
            5.1133800              1.0000000
        Au H
            3.4081930              1.0000000
        Au H
            1.6497500              1.0000000
        Au H
            0.7040980              1.0000000
        Au I
            1.7233740              1.0000000''')}
        if mp2fit == False:
            auxbasis.update({'C':'aug-cc-pvtz-jkfit', 'P':'aug-cc-pvtz-jkfit', 'N':'aug-cc-pvtz-jkfit', 'H':'aug-cc-pvtz-jkfit'})
        else:
            auxbasis.update({'C':'aug-cc-pvtz-ri', 'P':'aug-cc-pvtz-ri', 'N':'aug-cc-pvtz-ri', 'H':'aug-cc-pvtz-ri'})
    elif 'Cu' in atom_list:
        auxbasis = {}
        for atm in set(atom_list):
            if mp2fit == False:
                auxbasis[atm] = 'cc-pvtz-jkfit'
            else:
                auxbasis[atm] = 'cc-pvtz-ri'
        auxbasis['Cu'] = gto.basis.parse('''
            Cu    S
                1989.8442284              1.0000000
            Cu    S
                1099.1821595              1.0000000
            Cu    S
                489.24591409             1.0000000
            Cu    S
                190.67771441             1.0000000
            Cu    S
                89.659837230            1.0000000
            Cu    S
                43.561669805            1.0000000
            Cu    S
                13.818747221            1.0000000
            Cu    S
                4.0531945343           1.0000000
            Cu    S
                2.4825335230           1.0000000
            Cu    S
                1.0385959358           1.0000000
            Cu    S
                0.64586753328          1.0000000
            Cu    S
                0.25733171364          1.0000000
            Cu    S
                0.14235554835          1.0000000
            Cu    P
                551.84062390             1.0000000
            Cu    P
                171.53878246             1.0000000
            Cu    P
                46.718917626            1.0000000
            Cu    P
                17.994412589            1.0000000
            Cu    P
                6.8613676394           1.0000000
            Cu    P
                4.2422257285           1.0000000
            Cu    P
                1.6469239386           1.0000000
            Cu    P
                1.0661440298           1.0000000
            Cu    P
                0.47392463185          1.0000000
            Cu    P
                0.20637480741          1.0000000
            Cu    P
                0.92362763570E-01      1.0000000
            Cu    D
                152.86424703             1.0000000
            Cu    D
                45.360919088            1.0000000
            Cu    D
                17.361558462            1.0000000
            Cu    D
                12.305715759            1.0000000
            Cu    D
                4.5145510029           1.0000000
            Cu    D
                2.9894775496           1.0000000
            Cu    D
                1.1623467499           1.0000000
            Cu    D
                0.67133977507          1.0000000
            Cu    D
                0.25914055087          1.0000000
            Cu    F
                57.363728452            1.0000000
            Cu    F
                12.458705005            1.0000000
            Cu    F
                6.7168718399           1.0000000
            Cu    F
                3.5906356059           1.0000000
            Cu    F
                1.6107232146           1.0000000
            Cu    F
                0.81548413376          1.0000000
            Cu    F
                0.34962438020          1.0000000
            Cu    G
                21.326579225            1.0000000
            Cu    G
                7.2891062979           1.0000000
            Cu    G
                3.5722718000           1.0000000
            Cu    G
                1.3135972169           1.0000000
            Cu    G
                0.54086964465          1.0000000
            Cu    H
                10.853374411            1.0000000
            Cu    H
                5.5795302535           1.0000000
            Cu    H
                2.2716457145           1.0000000
            Cu    I
                9.6118985121           1.0000000
            Cu    I
                5.0542964769           1.0000000''')
    elif 'Pt' in atom_list:
        auxbasis = {}
        for atm in set(atom_list):
            if mp2fit == False:
                auxbasis[atm] = 'cc-pvtz-jkfit'
            else:
                auxbasis[atm] = 'cc-pvtz-ri'
        auxbasis['Pt'] = gto.basis.parse('''
            Pt    S
                6.1305200              1.0000000
            Pt    S
                4.0660100              1.0000000
            Pt    S
                2.9628700              1.0000000
            Pt    S
                1.6612100              1.0000000
            Pt    S
                0.8100970              1.0000000
            Pt    S
                0.3399450              1.0000000
            Pt    S
                0.1901450              1.0000000
            Pt    S
                0.1028010              1.0000000
            Pt    S
                0.0382890              1.0000000
            Pt    S
                0.0199330              1.0000000
            Pt    P
                6.9532900              1.0000000
            Pt    P
                4.1130500              1.0000000
            Pt    P
                2.7957800              1.0000000
            Pt    P
                1.4479700              1.0000000
            Pt    P
                0.8107610              1.0000000
            Pt    P
                0.4383160              1.0000000
            Pt    P
                0.2071000              1.0000000
            Pt    P
                0.1055190              1.0000000
            Pt    P
                0.0581880              1.0000000
            Pt    P
                0.0252980              1.0000000
            Pt    D
                4.2768200              1.0000000
            Pt    D
                3.3198700              1.0000000
            Pt    D
                2.5469100              1.0000000
            Pt    D
                1.2368100              1.0000000
            Pt    D
                0.5805070              1.0000000
            Pt    D
                0.3257320              1.0000000
            Pt    D
                0.1554420              1.0000000
            Pt    D
                0.0930930              1.0000000
            Pt    D
                0.0404690              1.0000000
            Pt    F
                5.8710200              1.0000000
            Pt    F
                3.0234500              1.0000000
            Pt    F
                1.7547200              1.0000000
            Pt    F
                0.8547130              1.0000000
            Pt    F
                0.4989610              1.0000000
            Pt    F
                0.2349000              1.0000000
            Pt    F
                0.0908070              1.0000000
            Pt    G
                7.7172600              1.0000000
            Pt    G
                3.0401700              1.0000000
            Pt    G
                1.5881600              1.0000000
            Pt    G
                0.9300910              1.0000000
            Pt    G
                0.4149940              1.0000000
            Pt    G
                0.2099720              1.0000000
            Pt    H
                2.4381500              1.0000000
            Pt    H
                1.4414600              1.0000000
            Pt    H
                0.7407190              1.0000000
            Pt    I
                2.5327300              1.0000000
            Pt    I
                1.5329100              1.0000000''')
    return auxbasis

'''
swzhang edited for ORCA usage
'''
def get_M_orca(coord, basis, verbose):
    verified_basis = ["cc-pVDZ", "aug-cc-pVTZ", "cc-pVTZ", "def2-SVP", "def2-TZVP", "def2-QZVPP", "3-21G", "6-31G", "6-31G*", "6-31+G**", ]
    verified_basis = [i.lower().replace('-', '') for i in verified_basis]

    if not basis.lower().replace('-', '') in verified_basis:
        raise NotImplementedError(f"ORCA basis set {basis} not available yet")

    mole = gto.Mole()
    mole.atom = coord
    mole.basis = basis
    mole.charge = int(os.environ.get("charge", 0))
    mole.spin = int(os.environ.get("spin", 0))
    mole.build(verbose=verbose)

    return mole